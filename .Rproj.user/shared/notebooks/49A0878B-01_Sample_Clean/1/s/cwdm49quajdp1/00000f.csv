"0","cov_all = colnames(dat_all)"
"0","cov_num = c(which(cov_all == 'Age'),"
"0","             which(cov_all == 'sex'),"
"0","             which(cov_all == 'race'),"
"0","             which(cov_all == 'Education'),"
"0","             which(cov_all == 'center'),"
"0","             which(cov_all == 'smoking'),"
"0","             which(cov_all == 'drinking'))"
"0",""
"0","df_grouped <- split(dat_all, dat_all$subjectid)"
"0",""
"0","for (i in 1:length(df_grouped)) {"
"0","  subject_data <- df_grouped[[i]]"
"0","  if (dim(subject_data)[1] <= 1){next}"
"0","  "
"0","  # Process for each variable"
"0","  ## The number where the co-variable begins"
"0","  num_cov = which(colnames(subject_data) == 'sex')"
"0","  for (j in cov_num) {"
"0","    var <- subject_data[, j]"
"0","    missing_values <- is.na(var) # find the missing values"
"0","    "
"0","    # if the current variable missed, we will use the former observation to impute."
"0","    for (k in 2:length(var)) {"
"0","      if (missing_values[k] && !missing_values[k - 1]) {"
"0","        var[k] <- var[k - 1]"
"0","      }"
"0","    }"
"0","    "
"0","    subject_data[, j] <- var"
"0","  }"
"0","  "
"0","  df_grouped[[i]] <- subject_data"
"0","}"
"0",""
"0","# combine processed data"
"0","df_filled <- do.call(rbind, df_grouped)"
"0","dat_V9_final = df_filled[df_filled$Visit == 'V9',]"
"0",""
"0","write.csv(dat_V9_final, '00_Intermediate_output/Cov_dat_V9.csv')"
