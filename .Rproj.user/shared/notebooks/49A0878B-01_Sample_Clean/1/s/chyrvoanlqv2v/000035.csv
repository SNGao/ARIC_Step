"0","data = result.noextreme"
"0","# data[,-1] = scale(data[,-1])"
"0",""
"0","bland_altman_plots = list()"
"0","for (i in 1:(length(algorithms) - 1)) {"
"0","  for (j in (i+1):length(algorithms)) {"
"0","    # 计算 Bland-Altman 数据"
"0","    ba_data <- blandr.statistics(data[[algorithms[i]]], data[[algorithms[j]]])"
"0","    "
"0","    # 创建一个数据框，包含差异和平均值"
"0","    plot_data <- data.frame("
"0","      mean = (data[[algorithms[i]]] + data[[algorithms[j]]]) / 2,"
"0","      difference = data[[algorithms[i]]] - data[[algorithms[j]]]"
"0","    )"
"0","    print(cor.test(plot_data$mean, plot_data$difference))"
"0","    # 进行线性回归"
"0","    lm_fit <- lm(difference ~ mean, data = plot_data)"
"0","    # print(summary(lm_fit))"
"0","    lm_coef <- tidy(lm_fit)"
"0","    "
"0","    # 提取系数"
"0","    intercept <- lm_coef$estimate[1]"
"0","    slope <- lm_coef$estimate[2]"
"0","    "
"0","    # 创建 Bland-Altman 图"
"0","    p <- ggplot(plot_data, aes(x = mean, y = difference)) +"
"0","      geom_point(alpha = 0.5) +"
"0","      geom_hline(yintercept = ba_data$bias, color = ""blue"", linetype = ""dashed"") +"
"0","      geom_hline(yintercept = ba_data$upperLOA, color = ""red"", linetype = ""dashed"") +"
"0","      geom_hline(yintercept = ba_data$lowerLOA, color = ""red"", linetype = ""dashed"") +"
"0","      geom_smooth(method = ""loess"", color = ""green"", se = TRUE, span = 2) +  "
"0","      labs("
"0","        x = ""Mean of two measurements"","
"0","        y = ""Difference between measurements"","
"0","        title = paste0(algorithms[i], ' - ', algorithms[j]),"
"0","        subtitle = ""Bland-Altman Plot with Linear Regression"""
"0","      ) +"
"0","      custom_theme +"
"0","      annotate(""text"", x = min(plot_data$mean), "
"0","               y = max(plot_data$difference), "
"0","               label = sprintf(""y = %.3fx + %.3f"", slope, intercept), "
"0","               hjust = 0, vjust = 1)"
"0","    "
"0","    # 保存图形"
"0","    bland_altman_plots[[paste(algorithms[i], algorithms[j], sep = ""_vs_"")]] <- p"
"0","  }"
"0","}"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = -86.652, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.9359014 -0.9202711"
"1",""
"1","
"
"1","sample estimates:
"
"1","       cor "
"1","
"
"1","-0.9284964 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = -174.94, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.9829590 -0.9786771"
"1",""
"1","
"
"1","sample estimates:
"
"1","       cor "
"1","
"
"1","-0.9809368 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = -86.377, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.9355342 -0.9198179"
"1",""
"1","
"
"1","sample estimates:
"
"1","       cor "
"1","
"
"1","-0.9280882 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = -63.483, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.8900922 -0.8640756"
"1",""
"1","
"
"1","sample estimates:
"
"1","       cor "
"1","
"
"1","-0.8777292 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = -64.842, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.8939009 -0.8687232"
"1",""
"1","
"
"1","sample estimates:
"
"1","       cor "
"1","
"
"1","-0.8819395 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = 0.60175, df = 1201, p-value = 0.5475"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.03919622  0.07380780"
"1",""
"1","
"
"1","sample estimates:
"
"1","       cor "
"1","
"
"1","0.01736123 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = 29.852, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","0.6189627 0.6839403"
"1",""
"1","
"
"1","sample estimates:
"
"1","      cor "
"1","
"
"1","0.6526499 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = 51.937, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","0.8135502 0.8484513"
"1",""
"1","
"
"1","sample estimates:
"
"1","      cor "
"1","
"
"1","0.8318212 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = 73.424, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","0.8934777 0.9141259"
"1",""
"1","
"
"1","sample estimates:
"
"1","      cor "
"1","
"
"1","0.9043295 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","plot_data$mean and plot_data$difference"
"1",""
"1","
"
"1","t = 12.813, df = 1201, p-value < 2.2e-16"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","0.2960563 0.3955395"
"1",""
"1","
"
"1","sample estimates:
"
"1","      cor "
"1","
"
"1","0.3467728 "
"1","
"
"1","
"
"0","combined_plot <- wrap_plots("
"0","  #bland_altman_plots$adept_vs_adept,"
"0","  bland_altman_plots$adept_vs_oak,"
"0","  bland_altman_plots$adept_vs_sdt,"
"0","  bland_altman_plots$adept_vs_stepcount_ssl,"
"0","  bland_altman_plots$adept_vs_vs,"
"0","  plot.null,"
"0","  #bland_altman_plots$oak_vs_oak,"
"0","  bland_altman_plots$oak_vs_sdt,"
"0","  bland_altman_plots$oak_vs_stepcount_ssl,"
"0","  bland_altman_plots$oak_vs_vs,"
"0","  plot.null,"
"0","  plot.null,"
"0","  #bland_altman_plots$sdt_vs_sdt,"
"0","  bland_altman_plots$sdt_vs_stepcount_ssl,"
"0","  bland_altman_plots$sdt_vs_vs,"
"0","  plot.null,"
"0","  plot.null,"
"0","  plot.null,"
"0","  #bland_altman_plots$stepcount_ssl_vs_stepcount_ssl,"
"0","  bland_altman_plots$stepcount_ssl_vs_vs,"
"0","  ncol = 4"
"0",") & "
"0","theme(legend.position = 'bottom')"
