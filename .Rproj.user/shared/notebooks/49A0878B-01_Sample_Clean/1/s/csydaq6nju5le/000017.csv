"0","data = result.noextreme"
"0","data[,-1] = scale(data[,-1])"
"0",""
"0","bland_altman_plots = list()"
"0","for (i in 1:(length(algorithms) - 1)) {"
"0","  for (j in (i+1):length(algorithms)) {"
"0","    # 计算 Bland-Altman 数据"
"0","    ba_data <- blandr.statistics(data[[algorithms[i]]], data[[algorithms[j]]])"
"0","    "
"0","    # 创建一个数据框，包含差异和平均值"
"0","    plot_data <- data.frame("
"0","      mean = 10*(data[[algorithms[i]]] + data[[algorithms[j]]]) / 2,"
"0","      difference = 10*data[[algorithms[i]]] - data[[algorithms[j]]]"
"0","    )"
"0","    "
"0","    # 进行线性回归"
"0","    lm_fit <- lm(difference ~ mean, data = plot_data)"
"0","    print(summary(lm_fit))"
"0","    lm_coef <- tidy(lm_fit)"
"0","    "
"0","    # 提取系数"
"0","    intercept <- lm_coef$estimate[1]"
"0","    slope <- lm_coef$estimate[2]"
"0","    "
"0","    # 创建 Bland-Altman 图"
"0","    p <- ggplot(plot_data, aes(x = mean, y = difference)) +"
"0","      geom_point(alpha = 0.5) +"
"0","      geom_hline(yintercept = ba_data$bias, color = ""blue"", linetype = ""dashed"") +"
"0","      geom_hline(yintercept = ba_data$upperLOA, color = ""red"", linetype = ""dashed"") +"
"0","      geom_hline(yintercept = ba_data$lowerLOA, color = ""red"", linetype = ""dashed"") +"
"0","      geom_smooth(method = ""lm"", color = ""green"", se = TRUE) +  # 线性回归线"
"0","      labs("
"0","        x = ""Mean of two measurements"","
"0","        y = ""Difference between measurements"","
"0","        title = paste0(algorithms[i], ' - ', algorithms[j]),"
"0","        subtitle = ""Bland-Altman Plot with Linear Regression"""
"0","      ) +"
"0","      custom_theme +"
"0","      annotate(""text"", x = min(plot_data$mean), "
"0","               y = max(plot_data$difference), "
"0","               label = sprintf(""y = %.3fx + %.3f"", slope, intercept), "
"0","               hjust = 0, vjust = 1)"
"0","    "
"0","    # 保存图形"
"0","    bland_altman_plots[[paste(algorithms[i], algorithms[j], sep = ""_vs_"")]] <- p"
"0","  }"
"0","}"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-13.0621 "
"1"," -2.0145 "
"1","  0.2041 "
"1","  1.7938 "
"1"," 20.0102 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -8.988e-16"
"1","  1.063e-01"
"1","     0.0"
"1","        1"
"1","    "
"1","
mean       "
"1","  9.000e-01"
"1","  1.129e-02"
"1","    79.7"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","3.689"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.841"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8409"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 6352"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-14.592 "
"1"," -3.255 "
"1"," -0.161 "
"1","  2.654 "
"1"," 27.466 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 1.664e-16"
"1","  1.481e-01"
"1","    0.00"
"1","        1"
"1","    "
"1","
mean       "
"1"," 9.000e-01"
"1","  1.676e-02"
"1","   53.71"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","5.138"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.706"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.7058"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 2885"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-15.9409 "
"1"," -2.0735 "
"1","  0.1633 "
"1","  2.0463 "
"1"," 17.9553 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 5.070e-16"
"1","  1.053e-01"
"1","    0.00"
"1","        1"
"1","    "
"1","
mean       "
"1"," 9.000e-01"
"1","  1.117e-02"
"1","   80.58"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","3.653"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8439"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8438"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 6493"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-18.4624 "
"1"," -1.7689 "
"1","  0.3426 "
"1","  1.6622 "
"1"," 21.2626 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -3.944e-16"
"1","  1.080e-01"
"1","    0.00"
"1","        1"
"1","    "
"1","
mean       "
"1","  9.000e-01"
"1","  1.149e-02"
"1","   78.35"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","3.745"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8364"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8362"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 6139"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-10.4760 "
"1"," -1.9818 "
"1","  0.0165 "
"1","  1.9991 "
"1"," 14.2786 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 1.695e-15"
"1","  9.039e-02"
"1","     0.0"
"1","        1"
"1","    "
"1","
mean       "
"1"," 9.000e-01"
"1","  9.434e-03"
"1","    95.4"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","3.135"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8834"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8833"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 9102"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-11.321 "
"1"," -2.052 "
"1"," -0.088 "
"1","  1.821 "
"1"," 14.371 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 1.096e-15"
"1","  9.480e-02"
"1","    0.00"
"1","        1"
"1","    "
"1","
mean       "
"1"," 9.000e-01"
"1","  9.938e-03"
"1","   90.56"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","3.288"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8723"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8722"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 8202"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-8.3303 "
"1","-0.8584 "
"1"," 0.0092 "
"1"," 0.8867 "
"1"," 6.1341 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 4.379e-16"
"1","  4.504e-02"
"1","     0.0"
"1","        1"
"1","    "
"1","
mean       "
"1"," 9.000e-01"
"1","  4.552e-03"
"1","   197.7"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","1.562"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.9702"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.9702"
"1"," "
"1","
F-statistic:"
"1"," "
"1","3.909e+04"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-11.7039 "
"1"," -2.6787 "
"1"," -0.3744 "
"1","  2.4012 "
"1"," 18.1641 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -6.146e-16"
"1","  1.182e-01"
"1","    0.00"
"1","        1"
"1","    "
"1","
mean       "
"1","  9.000e-01"
"1","  1.274e-02"
"1","   70.64"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","4.099"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.806"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8059"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 4991"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-15.9724 "
"1"," -2.4359 "
"1","  0.0095 "
"1","  2.4896 "
"1"," 14.1380 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -8.835e-16"
"1","  1.118e-01"
"1","    0.00"
"1","        1"
"1","    "
"1","
mean       "
"1","  9.000e-01"
"1","  1.195e-02"
"1","   75.29"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","3.878"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8252"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.825"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 5669"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = difference ~ mean, data = plot_data)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-19.0064 "
"1"," -2.0604 "
"1"," -0.0137 "
"1","  2.1664 "
"1"," 11.5411 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -5.685e-16"
"1","  1.055e-01"
"1","     0.0"
"1","        1"
"1","    "
"1","
mean       "
"1","  9.000e-01"
"1","  1.119e-02"
"1","    80.4"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","3.66"
"1"," "
"1","on"
"1"," "
"1","1201"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8433"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8432"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 6464"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","1201"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","combined_plot <- wrap_plots("
"0","  #bland_altman_plots$adept_vs_adept,"
"0","  bland_altman_plots$adept_vs_oak,"
"0","  bland_altman_plots$adept_vs_sdt,"
"0","  bland_altman_plots$adept_vs_stepcount_ssl,"
"0","  bland_altman_plots$adept_vs_vs,"
"0","  plot.null,"
"0","  #bland_altman_plots$oak_vs_oak,"
"0","  bland_altman_plots$oak_vs_sdt,"
"0","  bland_altman_plots$oak_vs_stepcount_ssl,"
"0","  bland_altman_plots$oak_vs_vs,"
"0","  plot.null,"
"0","  plot.null,"
"0","  #bland_altman_plots$sdt_vs_sdt,"
"0","  bland_altman_plots$sdt_vs_stepcount_ssl,"
"0","  bland_altman_plots$sdt_vs_vs,"
"0","  plot.null,"
"0","  plot.null,"
"0","  plot.null,"
"0","  #bland_altman_plots$stepcount_ssl_vs_stepcount_ssl,"
"0","  bland_altman_plots$stepcount_ssl_vs_vs,"
"0","  ncol = 4"
"0",") & "
"0","theme(legend.position = 'bottom')"
