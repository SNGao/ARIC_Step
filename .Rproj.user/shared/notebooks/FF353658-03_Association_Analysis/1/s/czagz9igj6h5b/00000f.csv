"0","library(forestploter)"
"0","library(grid)"
"0","library(ggpubr)"
"0","library(ggplotify)"
"0",""
"0","forest.function.binary <- function(combined_dt, legend = TRUE){"
"0","  combined_dt$outcome = mod_name(combined_dt$outcome)"
"0","  dat.forest = combined_dt |>"
"0","    dplyr::select(outcome, algorithm, OR, P_value, Lower, Upper) |>"
"0","    dplyr::mutate(outcome = paste0(' ', outcome))"
"0","  "
"0","  dat.forest <- dat.forest %>%"
"0","    pivot_wider("
"0","      names_from = algorithm,"
"0","      values_from = c(OR, P_value, Lower, Upper))"
"0","  "
"0","  dat.forest$plot <- paste(rep("" "", 25), collapse = "" "")"
"0","  dat.forest$ci1 <- paste(sprintf(""%.2f (%.2f, %.2f)"", dat.forest$OR_ADEPT, "
"0","                                  dat.forest$Lower_ADEPT, dat.forest$Upper_ADEPT),"
"0","                          sprintf(""%.2f (%.2f, %.2f)"", dat.forest$OR_Oak,"
"0","                                  dat.forest$Lower_Oak, dat.forest$Upper_Oak),"
"0","                          sprintf(""%.2f (%.2f, %.2f)"", dat.forest$OR_SDT,"
"0","                                  dat.forest$Lower_SDT, dat.forest$Upper_SDT),"
"0","                          sprintf(""%.2f (%.2f, %.2f)"", dat.forest$OR_Stepcount,"
"0","                                  dat.forest$Lower_Stepcount, dat.forest$Upper_Stepcount),"
"0","                          sprintf(""%.2f (%.2f, %.2f)"", dat.forest$OR_Verisense,"
"0","                                  dat.forest$Lower_Verisense, dat.forest$Upper_Verisense),"
"0","                  sep = ""\n"")"
"0","  # dat.forest = dat.forest |>"
"0","  #   mutate(`Coef (95%CI)` = sprintf(""%.2f (%.2f, %.2f)"", Estimate, Lower, Upper))"
"0","  "
"0","  ## Drawing"
"0","  tm <- forest_theme(base_size = 7,"
"0","                     refline_lty = ""solid"","
"0","                     ci_lwd = 1.2,"
"0","                     ci_pch = c(15, 15, 15, 15, 15),"
"0","                     ci_col = c(""#3D72BE"", ""#E74C3C"",""#97470C"",""#4CAF50"", ""#FFC107""),"
"0","                     footnote_col = ""blue"","
"0","                     # footnote_cex = 1, # reference line width"
"0","                     legend_name = "" "", #""Step Algorithm"","
"0","                     legend_value = case_when(legend == TRUE ~ step_algorithms,"
"0","                                              legend == FALSE ~ rep("""", 5)),"
"0","                     vertline_lty = c(""dashed"", ""dotted""),"
"0","                     vertline_col = c(""#d6604d"", ""#bababa""),"
"0","                     # Table cell padding, width 4 and heights 3"
"0","                     core = list(padding = unit(c(2, 0.5), ""mm"")"
"0","                                 ))"
"0","  "
"0","  # modify Column Name"
"0","  colnames(dat.forest)[which(colnames(dat.forest) == 'outcome')] = 'Outcome'"
"0","  colnames(dat.forest)[which(colnames(dat.forest) == 'plot')] = ' '"
"0","  colnames(dat.forest)[which(colnames(dat.forest) == 'ci1')] = 'OR (95%CI)'"
"0","  "
"0","  p <- forest(dat.forest[,c(1, 22, 23)],"
"0","              est = list(dat.forest$OR_ADEPT,"
"0","                         dat.forest$OR_Oak,"
"0","                         dat.forest$OR_SDT,"
"0","                         dat.forest$OR_Stepcount,"
"0","                         dat.forest$OR_Verisense"
"0","                         ),"
"0","              lower = list(dat.forest$Lower_ADEPT,"
"0","                           dat.forest$Lower_Oak,"
"0","                           dat.forest$Lower_SDT,"
"0","                           dat.forest$Lower_Stepcount,"
"0","                           dat.forest$Lower_Verisense"
"0","                           ), "
"0","              upper = list(dat.forest$Upper_ADEPT,"
"0","                           dat.forest$Upper_Oak,"
"0","                           dat.forest$Upper_SDT,"
"0","                           dat.forest$Upper_Stepcount,"
"0","                           dat.forest$Upper_Verisense),"
"0","              ci_column = c(2),"
"0","              sizes = 0.4,"
"0","              ref_line = 1,"
"0","              # vert_line = c(0.5, 2),"
"0","              nudge_y = 0.15,"
"0","              xlim = c(0.2, 1.3),"
"0","              ticks_at = c(0.2, 1, 1.2),"
"0","              theme = tm) |>"
"0","  edit_plot(row = c(1:5),"
"0","            col = 1,"
"0","            gp = gpar(fontface = ""bold"", fontsize = 7)) |>"
"0","  edit_plot(row = c(1:5),"
"0","            col = 3,"
"0","            gp = gpar(fontsize = 6)) |>"
"0","  add_border(part = ""header"", where = c(""bottom"")) |>"
"0","  add_border(part = ""header"", where = c(""top""))"
"0","  "
"0","  return(p)"
"0","}"
