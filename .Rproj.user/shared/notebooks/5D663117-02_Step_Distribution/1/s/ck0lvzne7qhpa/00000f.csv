"0","# Define continuous covariates for plotting"
"0","cov_continuous <- c(""Age"") # Add other continuous covariates like ""SPPB"" if needed"
"0","plot_list_all <- list()"
"0",""
"0","# Generate plots for each covariate and step algorithm"
"0","for (covariate in cov_continuous) {"
"0","  plot_list <- lapply(step_algorithms, function(var) {"
"0","    ggplot(dat_vis, aes(x = .data[[covariate]], y = .data[[var]])) +"
"0","      geom_smooth(se = TRUE, color = ""#3D72BE"") + # Smoothed trend line"
"0","      labs("
"0","        x = ifelse(covariate == ""Age"", ""Age (years)"", ""SPPB (score)""),"
"0","        y = ""Step Counts"","
"0","        title = var"
"0","      ) +"
"0","      theme_minimal() + "
"0","      custom_theme +"
"0","      # scale_y_continuous(limits = case_when(var=='ADEPT'~c(0,2000),"
"0","      #                                       var=='Oak'~c(1000,8000),"
"0","      #                                       var=='SDT'~c(15000,30000),"
"0","      #                                       var=='Stepcount'~c(1000,7000),"
"0","      #                                       var=='Verisense'~c(1000,5000)),"
"0","      #                    breaks = function(x) pretty(x, n = 3))+"
"0","      scale_y_continuous(breaks = pretty) +"
"0","      scale_x_continuous(breaks = pretty)"
"0","  })"
"0","  "
"0","  names(plot_list) <- paste0(step_algorithms, '-', covariate)"
"0","  plot_list_all <- c(plot_list_all, plot_list)"
"0","}"
"0",""
"0","# Combine all plots into one grid"
"0","combined_plot <- wrap_plots(plot_list_all, ncol = 5) + "
"0","  plot_layout(guides = ""collect"") & "
"0","  theme(legend.position = 'bottom')"
"0",""
"0","# Save combined plot to file"
"0","png('Results/04_Continuous_Steps.png', height = 5, width = 10, units = 'in', res = 300)"
"0","print(combined_plot)"
"1","[38;5;232m`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = ""cs"")'[39m
"
"1","[38;5;232m`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = ""cs"")'[39m
"
"1","[38;5;232m`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = ""cs"")'[39m
"
"1","[38;5;232m`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = ""cs"")'[39m
"
"1","[38;5;232m`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = ""cs"")'[39m
"
