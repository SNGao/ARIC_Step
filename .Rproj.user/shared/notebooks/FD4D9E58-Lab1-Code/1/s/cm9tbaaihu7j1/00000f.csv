"0","library(ggplot2)"
"0","library(reshape2)"
"0",""
"0","dat_long <- melt(dat, id.vars = ""id"", "
"0","                 variable.name = ""Visit"", "
"0","                 value.name = ""SF36_Mental"")"
"0",""
"0","# Convert Visit to a numeric factor"
"0","dat_long$Visit <- as.numeric(gsub(""y"", """", dat_long$Visit))"
"0",""
"0","# Create the spaghetti plot"
"0","ggplot(dat_long, aes(x = Visit, y = SF36_Mental, group = id)) +"
"0","  geom_line(color = ""grey"", alpha = 0.5) +  # Individual lines"
"0","  geom_boxplot(aes(group = Visit), width = 0.4, alpha = 0.5) +  # Boxplots"
"0","  stat_summary(aes(group = 1), fun = mean, geom = ""point"","
"0","               shape = 19, size = 3, color = ""black"") +  # Mean points"
"0","  stat_summary(aes(group = 1), fun = mean, geom = ""line"","
"0","               color = ""red"", size = 0.5,"
"0","               alpha = 0.4) +  # Mean line"
"0","  labs(title = ""Spaghetti Plot of SF-36 Mental vs Visit"", x = ""Visit"", y = ""SF-36 Mental"") +"
"0","  theme_minimal()"
